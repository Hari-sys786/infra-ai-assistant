<div class="upload-page">
  <div class="page-header">
    <h1>üìÅ Document Management</h1>
    <p class="subtitle">Upload PDFs and HTML files to index them for RAG retrieval</p>
  </div>

  <div class="upload-grid">
    <!-- Upload Card -->
    <div class="card glass-card upload-card">
      <div class="card-header">
        <h2>Upload Document</h2>
      </div>

      <div class="vendor-field">
        <label>Vendor / Category</label>
        <input
          type="text"
          [(ngModel)]="vendor"
          placeholder="e.g., Cisco, Dell, Custom"
          class="text-input"
        />
      </div>

      <div
        class="drop-zone"
        [class.dragging]="isDragging"
        [class.uploading]="isUploading"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        (click)="fileInput.click()"
      >
        <div class="drop-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </div>
        <p class="drop-text">Drag & drop a file here</p>
        <p class="drop-hint">or click to browse ‚Äî PDF, HTML supported</p>
        <input #fileInput type="file" accept=".pdf,.html,.htm" (change)="onFileSelected($event)" hidden />
      </div>

      <!-- Upload Status -->
      <div class="upload-status" *ngIf="uploadProgress">
        <div class="progress-bar" *ngIf="isUploading">
          <div class="progress-fill"></div>
        </div>
        <p [class.success]="uploadSuccess" [class.error]="!uploadSuccess && !isUploading">
          {{ uploadProgress }}
        </p>
      </div>
    </div>

    <!-- Documents Table -->
    <div class="card glass-card docs-card">
      <div class="card-header">
        <h2>Indexed Documents</h2>
        <span class="chunk-badge">{{ totalChunks }} chunks</span>
      </div>

      <div class="docs-table-wrapper" *ngIf="documents.length > 0">
        <table class="docs-table">
          <thead>
            <tr>
              <th>Vendor</th>
              <th>Document</th>
              <th>Chunks</th>
              <th>Pages</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let doc of documents" class="fade-in">
              <td>
                <span class="vendor-badge">{{ doc.vendor }}</span>
              </td>
              <td class="doc-name">{{ doc.document }}</td>
              <td>{{ doc.chunk_count }}</td>
              <td>{{ doc.page_count }}</td>
              <td>
                <button class="delete-btn" (click)="deleteDocument(doc)" title="Delete">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="empty-state" *ngIf="documents.length === 0">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
        </svg>
        <p>No documents indexed yet</p>
        <span>Upload some files to get started!</span>
      </div>
    </div>
  </div>
</div>
